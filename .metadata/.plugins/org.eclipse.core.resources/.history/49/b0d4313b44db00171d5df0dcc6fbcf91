package lab4;

import java.io.*;
import java.util.ArrayList;

public class CardStatement {

	public static void main(String[] args) {
		
		String fileName = "CreditStatement.csv";
		File file = new File(fileName);
		ArrayList<CreditCard> card = new ArrayList<CreditCard>();
		String cards;
		double finalBalance = 0.0;
		
		try {
			BufferedReader br = new BufferedReader(new FileReader(file));
			while((cards = br.readLine()) != null) {
				String[] line = cards.split(",");
				String date = line[0];
				String type = line[1];
				String vendor = line[2];
				double amount = Double.parseDouble(line[3]);
				card.add(new CreditCard(date,type,vendor,amount));
			}
		}catch(FileNotFoundException e) {
			System.out.println("Error: unable to find the file");
		}catch(IOException e) {
			System.out.println("Error: unable to read file");
		}
		
		for(CreditCard stmt : card) {
			finalBalance = finalBalance + stmt.balance();
			System.out.println("Date\tType\tVendor\tAmount\tBalance");
			System.out.printf("%s\t%s\t%s\t%3.2f\t%3.2f\n",
					stmt.getDate(),stmt.getType(),stmt.getVendor(),stmt.getAmount(),finalBalance);
			
			if(finalBalance > 0) {
				finalBalance = (finalBalance*0.1)+finalBalance;
				System.out.println("\nWarning: Your final amount is more than zero.\nCharged a 10% fee.");
				System.out.printf("Final amount is $ %.2f\n", finalBalance);
				System.out.println("\n===");
			}
			else if(finalBalance == 0) {
				System.out.println("Thank you for your payment.\n\n===");			
			}
			else if(finalBalance < 0) {
				System.out.println("Thank you for your payment");
				System.out.println("Overpayment $" + stmt.getAmount() + "\n\n===");
			}
			
		}

	}

}
